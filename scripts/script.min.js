function filterDomains(e){var t=[];for(i=0;i<e.length;i++)for(j=0;j<IMAGE_DOMAINS.length;j++)if(e[i].data.domain===IMAGE_DOMAINS[j]&&(e[i].data.url.endsWith(".jpg")||e[i].data.url.endsWith(".jpeg")||e[i].data.url.endsWith(".png")||e[i].data.url.endsWith(".gif")||e[i].data.url.endsWith(".webm"))){t.push(e[i]);continue}return t}function filterNsfw(e){var t=[];for(i=0;i<e.length;i++)if(!e[i].data.over_18){t.push(e[i]);continue}return t}function init(){document.onkeydown=function(e){"Enter"===e.key&&guess()},getContent()}function getContent(){guessed=!1,promise=fetchContent(SUBREDDITS[Math.floor(Math.random()*SUBREDDITS.length)]).then(function(e){LISTING=e.data.children},function(e){console.log(e)}),huh=[],huh.push(promise),Promise.all(huh).then(function(){LISTING=filterDomains(LISTING),LISTING=filterNsfw(LISTING),0!=LISTING.length?(picked=Math.floor(Math.random()*LISTING.length),pickedData=LISTING[picked].data,document.getElementById("image").innerHTML='<img src="'+pickedData.url+'" style="max-width:100%;max-height:100%;display: inline-block;vertical-align: middle"/>',IMAGE_ID=pickedData.id,setContent()):(guessed=!0,document.getElementById("image").innerHTML='<error style="display:inline-block">Please Refresh or disable tracking protection</error>',setTimeout(function(){getContent()},2e3))})}function setContent(){duplicatePromise=fetchDuplicates(IMAGE_ID).then(function(e){DUPLICATE_LISTING=e[0].data.children.concat(e[1].data.children),console.log(DUPLICATE_LISTING)},function(e){console.log(e)}),huh=[],huh.push(duplicatePromise),Promise.all(huh).then(function(){for(items=[],i=0;i<DUPLICATE_LISTING.length;i++)DUPLICATE_LISTING[i].data.score>100&&items.push(DUPLICATE_LISTING[i].data.subreddit),document.getElementById("answers").innerHTML="";0==items.length&&(guessed=!0,document.getElementById("image").innerHTML="<error>Please Refresh</error>",setTimeout(function(){getContent()},2e3))})}function guess(){if(guessed)return void(document.getElementById("guess").value="");for(input=document.getElementById("guess").value,i=0;i<items.length;i++){if(items[i].toUpperCase()===input.toUpperCase()&&!guessed){document.getElementById("answers").innerHTML='<a style="color:green" target="_blank" href="https://www.reddit.com/r/'+items[i]+'/">/r/'+items[i]+"</a>",guessed=!0,score++,strike_count=0,document.getElementById("score").innerHTML="Score: "+score;break}i==items.length-1&&(strike_count++,4==strike_count?(strike_count=0,score=0,guessed=!0,document.getElementById("answers").innerHTML='<span style="color:red">Wrong! Answer is /r/'+items[0]+"</span>",document.getElementById("score").innerHTML="Score: "+score):document.getElementById("answers").innerHTML='<span style="color:red">Wrong! ('+(4-strike_count)+" tries left)</span>")}document.getElementById("guess").value="",guessed&&setTimeout(function(){getContent()},2e3)}function fetchContent(e){return url="https://www.reddit.com/r/",url=url.concat(e,"/top.json?sort=top&t=month"),fetch(url).then(function(e){if(e.status>=400)throw new Error("Bad response in fetchContent");return e.json()})}function fetchDuplicates(e){return url="https://www.reddit.com/duplicates/",url=url.concat(e,".json"),fetch(url).then(function(e){if(e.status>=400)throw new Error("Bad response in fetchContent");return e.json()})}var IMAGE_DOMAINS=["i.redd.it","i.imgur.com"],items=[],guessed=!0,score=0,LISTING={},DUPLICATE_LISTING={},IMAGE_ID=0,strike_count=0,disabled=!0,SUBREDDITS=["woahdude","aww","nevertellmetheodds","mildlyinteresting","iamverysmart","2meirl4meirl","insanepeoplefacebook","therewasanattempt","mildlyinfuriating","coaxedintoasnafu","madlads","crappydesign","thisismylifenow","youdontsurf","cringepics","iamverybadass","quityourbullshit","oopsdidntmeanto","comedycemetery","deepfriedmemes","murderedbywords","oldpeoplefacebook","indianpeoplefacebook","wholesomememes","justneckbeardthings","dontdeadopeninside","thathappened","hmmm","atbge","bonehurtingjuice","sbubby","fellowkids","im14andthisisdeep","dataisbeautiful","oldschoolcool","forwardsfromgrandma","perfecttiming","notmyjob","boottoobig","niceguys","evilbuildings","crappyoffbrands","justfuckmyshitup","penmanshipporn","dankchristianmemes","fakehistoryporn","assholedesign","choosingbeggars","coloringcorruptions","surrealmemes","perfectfit","natureisfuckinglit","tumblrinaction","dontyouknowwhoiam","ihavesex","restofthefuckingowl","whitepeopletwitter","blackpeopletwitter","tinder","comedynecrophilia","awwtf","badwomensanatomy","breadstapledtotrees","creepypms","creepyasterisks","dadreflexes","goodfaketexts","idiotsfightingthings","ilikthebred","kidsarefuckingstupid","okbuddyretard","nukedmemes","nothowdrugswork","pornhubcomments","restofthefuckingowl","trippinthroughtime","youdontsurf","nonononoyes","yesyesyesyesno","publicfreakouts","blackmagicfuckery","therewasanattempt"];