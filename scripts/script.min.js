/*! redditfeud 23-11-2017 */

function filterDomains(a){var b=[];for(i=0;i<a.length;i++)for(j=0;j<IMAGE_DOMAINS.length;j++)if(a[i].data.domain===IMAGE_DOMAINS[j]&&(a[i].data.url.endsWith(".jpg")||a[i].data.url.endsWith(".jpeg")||a[i].data.url.endsWith(".png"))){b.push(a[i]);continue}return b}function init(){getContent()}function getContent(){guessed=!1,promise=fetchContent(SUBREDDITS[Math.floor(Math.random()*SUBREDDITS.length)]).then(function(a){LISTING=a.data.children},function(a){console.log(a)}),huh=[],huh.push(promise),Promise.all(huh).then(function(){LISTING=filterDomains(LISTING),0!=LISTING.length?(picked=Math.floor(Math.random()*LISTING.length),pickedData=LISTING[picked].data,document.getElementById("image").innerHTML='<img src="'+pickedData.url+'" style="max-height:400px; max-width:auto;"/>',IMAGE_ID=pickedData.id,setContent()):(guessed=!0,alert("oops couldn't find anything"),setTimeout(function(){getContent()},2e3))})}function setContent(){duplicatePromise=fetchDuplicates(IMAGE_ID).then(function(a){DUPLICATE_LISTING=a[0].data.children.concat(a[1].data.children),console.log(DUPLICATE_LISTING)},function(a){console.log(a)}),huh=[],huh.push(duplicatePromise),Promise.all(huh).then(function(){for(items=[],i=0;i<DUPLICATE_LISTING.length;i++)DUPLICATE_LISTING[i].data.score>100&&items.push(DUPLICATE_LISTING[i].data.subreddit),document.getElementById("answers").innerHTML="???"})}function textSubmit(a){"Enter"===event.key&&guess()}function guess(){for(input=document.getElementById("guess").value,i=0;i<items.length;i++)if(items[i].toUpperCase()===input.toUpperCase()&&!guessed){document.getElementById("answers").innerHTML="/r/"+items[i],guessed=!0,score++,document.getElementById("score").innerHTML=score;break}document.getElementById("guess").value="",guessed&&setTimeout(function(){getContent()},2e3)}function fetchContent(a){return url="https://www.reddit.com/r/",url=url.concat(a,"/top.json?sort=top&t=month"),fetch(url).then(function(a){if(a.status>=400)throw new Error("Bad response in fetchContent");return a.json()})}function fetchDuplicates(a){return url="https://www.reddit.com/duplicates/",url=url.concat(a,".json"),fetch(url).then(function(a){if(a.status>=400)throw new Error("Bad response in fetchContent");return a.json()})}var IMAGE_DOMAINS=["i.redd.it","i.imgur.com"],items=[],guessed=!0,score=0,TEST=[["a",1],["b",2],["c",3],["d",4],["e",5],["f",6],["g",7],["h",8]],LISTING={},DUPLICATE_LISTING={},IMAGE_ID=0,SUBREDDITS=["woahdude","aww","nevertellmetheodds","mildlyinteresting","iamverysmart","2meirl4meirl","insanepeoplefacebook","therewasanattempt","mildlyinfuriating","coaxedintoasnafu","madlads","crappydesign","thisismylifenow","PeopleFuckingDying","youdontsurf","cringepics","iamverybadass","quityourbullshit","oopsdidntmeanto","comedycemetery","deepfriedmemes","murderedbywords","oldpeoplefacebook","indianpeoplefacebook","wholesomememes","justneckbeardthings","dontdeadopeninside","thathappened","maliciouscompliance","hmmm","atbge"];